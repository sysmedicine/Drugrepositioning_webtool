rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
cell_list<-as.matrix(c("A549","HCC515"))
dir="pos"#"pos" or "neg"
load("/Users/xiangyuli/Library/CloudStorage/OneDrive-Personal/Computer/Other_project/1-webtool/Source_data/rebuild_code_DR/meta_data/siginfo_beta_yuan.Rdata")#find in the meta_data folder,load sig_info
path_input="/Users/xiangyuli/Library/CloudStorage/OneDrive-Personal/Computer/Other_project/1-webtool/Source_data/rebuild_code_DR/Test/Output_2"
path_output="/Users/xiangyuli/Library/CloudStorage/OneDrive-Personal/Computer/Other_project/1-webtool/Source_data/rebuild_code_DR/Test/Output_3"
for (i in 1:length(cell_list)){
result=DR_filter_other_trt(path_input,path_output,sig_info,dir,cell_list[i])
}
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
##############################################33
#Main code----------perform
source("/Users/xiangyuli/Library/CloudStorage/OneDrive-Personal/Computer/Other_project/1-webtool/Source_data/rebuild_code_DR/DrugRepositioning_Functions_UPPMAX.R")
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
rm(list=ls())
##############################################33
#Main code----------perform
source("/Users/xiangyuli/Library/CloudStorage/OneDrive-Personal/Computer/Other_project/1-webtool/Source_data/rebuild_code_DR/DrugRepositioning_Functions_UPPMAX.R")
rm(list=ls())
rm(list=ls())
rm(list=ls())
##############################################33
#Main code----------perform
source("/Users/xiangyuli/Library/CloudStorage/OneDrive-Personal/Computer/Other_project/1-webtool/Source_data/rebuild_code_DR/DrugRepositioning_Functions_UPPMAX.R")
cell_list<-as.matrix(c("A549","HCC515"))
dir="pos"#"pos" or "neg"
load("/Users/xiangyuli/Library/CloudStorage/OneDrive-Personal/Computer/Other_project/1-webtool/Source_data/rebuild_code_DR/meta_data/siginfo_beta_yuan.Rdata")#find in the meta_data folder,load sig_info
path_input="/Users/xiangyuli/Library/CloudStorage/OneDrive-Personal/Computer/Other_project/1-webtool/Source_data/rebuild_code_DR/Test/Output_2"
path_output="/Users/xiangyuli/Library/CloudStorage/OneDrive-Personal/Computer/Other_project/1-webtool/Source_data/rebuild_code_DR/Test/Output_3"
for (i in 1:length(cell_list)){
result=DR_filter_other_trt(path_input,path_output,sig_info,dir,cell_list[i])
}
rm(list=ls())
rm(list=ls())
readRDS("/Volumes/XYMainDisk/E-disk/L1000_2021/cor_result/Full_target/sh/pos/target_info.Rds")
a<-readRDS("/Volumes/XYMainDisk/E-disk/L1000_2021/cor_result/Full_target/sh/pos/target_info.Rds")
View(a)
which(a$target_cmap_name=="MCM6")
index<-which(a$target_cmap_name=="MCM6")
View(a[index,])
h<-readRDS("/Users/xiangyuli/Library/CloudStorage/OneDrive-Personal/Computer/Other_project/1-webtool/Source_data/rebuild_code_DR/Test/Output_3/A549_Rmatrix_FilterBoth.Rds")
View(h)
rm(list=ls())
path_raw<-"/Users/xiangyuli/Library/CloudStorage/OneDrive-Personal/Computer/Other_project/1-webtool/Source_data/rebuild_code_DR/Test/Output_3/"
setwd(path_raw)
df_1<-readRDS("A549_Rmatrix_FilterBoth.Rds")
df_2<-readRDS("HCC515_Rmatrix_FilterBoth.Rds")
View(df_2)
View(df_1)
over_drug<-intersect(rownames(df_1),rownames(df_2))
df_1<-df_1[over_drug,]
df_2<-df_2[over_drug,]
path_raw<-"/Users/xiangyuli/Library/CloudStorage/OneDrive-Personal/Computer/Other_project/1-webtool/Source_data/rebuild_code_DR/Test/Output_3/"
setwd(path_raw)
df_1<-readRDS("A549_Rmatrix_FilterBoth.Rds")
df_2<-readRDS("HCC515_Rmatrix_FilterBoth.Rds")
over_drug<-intersect(rownames(df_1),rownames(df_2))
path_raw<-"/Users/xiangyuli/Library/CloudStorage/OneDrive-Personal/Computer/Other_project/1-webtool/Source_data/rebuild_code_DR/Test/Output_3/"
setwd(path_raw)
df_1<-readRDS("A549_Rmatrix_FilterBoth.Rds")
df_2<-readRDS("HCC515_Rmatrix_FilterBoth.Rds")
over_drug<-intersect(rownames(df_1),rownames(df_2))
df_end<-cbind(df_1[over_drug,1],df_2[over_drug,1])
View(df_end)
path_raw<-"/Users/xiangyuli/Library/CloudStorage/OneDrive-Personal/Computer/Other_project/1-webtool/Source_data/rebuild_code_DR/Test/Output_3/"
setwd(path_raw)
df<-readRDS(paste0(int_cell,"_Rmatrix_FilterBoth",""))
int_target="MCM6"#query gene
int_cell="A549"
#effect_type<-"inhibitor"#inhibitor or activator
#pert_type<-"sh"#perturbation type of data
abs_rcoef=0.4#absolute correlation coefficient no less than 0.4
top_num_drugs=10#extract the top 10 drugs
path_raw<-"/Users/xiangyuli/Library/CloudStorage/OneDrive-Personal/Computer/Other_project/1-webtool/Source_data/rebuild_code_DR/Test/Output_3/"
setwd(path_raw)
df<-readRDS(paste0(int_cell,"_Rmatrix_FilterBoth",""))
df<-readRDS(paste0(int_cell,"_Rmatrix_FilterBoth.RDS"))
df<-as.matrix(df[,int_cell])
df<-as.matrix(df[,int_target])
View(df)
rm(list=ls())
rm(list=ls())
drug_info<-as.data.frame(read.csv(file="/Users/xiangyuli/Library/CloudStorage/OneDrive-Personal/Computer/Other_project/1-webtool/Source_data/rebuild_code_DR/meta_data/drug_info.txt",header=T,sep="\t"))
int_target="MCM6"#query gene
int_cell="A549"
#effect_type<-"inhibitor"#inhibitor or activator
#pert_type<-"sh"#perturbation type of data
abs_rcoef=0.4#absolute correlation coefficient no less than 0.4
top_num_drugs=10#extract the top 10 drugs
path_raw<-"/Users/xiangyuli/Library/CloudStorage/OneDrive-Personal/Computer/Other_project/1-webtool/Source_data/rebuild_code_DR/Test/Output_3/"
setwd(path_raw)
df<-readRDS(paste0(int_cell,"_Rmatrix_FilterBoth.RDS"))
df<-as.matrix(df[,int_target])
View(df)
View(drug_info)
loc<-match(rownames(df),drug_info$pert_id)
path_raw<-"/Users/xiangyuli/Library/CloudStorage/OneDrive-Personal/Computer/Other_project/1-webtool/Source_data/rebuild_code_DR/Test/Output_3/"
setwd(path_raw)
df<-readRDS(paste0(int_cell,"_Rmatrix_FilterBoth.RDS"))
df<-as.matrix(df[,int_target])
loc<-match(rownames(df),drug_info$pert_id)
result<-cbind(as.data.frame(drug_info[loc,]),as.data.frame(df))
View(result)
View(result)
path_raw<-"/Users/xiangyuli/Library/CloudStorage/OneDrive-Personal/Computer/Other_project/1-webtool/Source_data/rebuild_code_DR/Test/Output_3/"
setwd(path_raw)
df<-readRDS(paste0(int_cell,"_Rmatrix_FilterBoth.RDS"))
df<-as.matrix(df[,int_target])
colnames(df)<-int_target
loc<-match(rownames(df),drug_info$pert_id)
result<-cbind(as.data.frame(drug_info[loc,]),as.data.frame(df))
View(result)
rank<-order(result[,3],decreasing = T)
result<-result[rank,]
View(result)
